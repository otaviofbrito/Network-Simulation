<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Simulação Tempo Real</title>
    <link rel="stylesheet" href="utils/template.css" />
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script
      id="MathJax-script"
      async
      src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"
    ></script>
    <script src="utils/template.js"></script>
  </head>
  <body>
    <div class="container">
      <header>
        <div class="nav">
          <a
            href="https://otaviofbrito.github.io/Network-Simulation/report_web/report.html"
          >
            < Simulação Pt. 1
          </a>
        </div>
        <h1>Simulação via Eventos Discretos</h1>
        <p class="subtitle">Discrete Time Event Simulation</p>
      </header>
      <div class="section">
        <h2>
          Simulação de Rede Segunda Parte (Navegação na Web e Chamadas em Tempo Real)
        </h2>
        <p>
          Nesta etapa, acrescentaremos ao simulador do roteador, a possibilidade de que os usuários realizem chamadas em tempo real.
          Além da simulação da <strong>navegação web</strong> realizada anteriormente, uniremos a simulação das chamadas web, 
          o que implica que o roteador atenderá a dois tipos de requisição: pacotes web e pacotes de chamadas.
           A simulação de chamadas ocorre de maneira similar com a simulação anterior, pois envolve a chegada de pacotes que seguem uma
          <strong>distribuição exponencial</strong>. Entretanto, para esse caso, as chamadas em tempo possuem um comportamento distinto, uma vez que
          podem ocorrer de forma simultânea.
        </p>
      </div>
      <hr class="stylized-line" />
      <div class="section">
        <h2>Cenário</h2>
        <p>
          Neste novo cenário, os pacotes de
          <strong>navegação web</strong> seguem o mesmo comportamento anterior.
          No entanto, com a adição deste novo evento, é necessário lidar com pacotes de
          <strong>chamadas em tempo real</strong>, que possuem características
          diferentes e principalmente, podem ocorrer de forma simultânea. Para realizarmos as
          simulações, é necessário controlar algumas variáveis. Com a adição
          deste evento, temos
          <strong>três variáveis aleatórias adicionais</strong>:
        </p>
        <ul>
          <li><strong>Intervalo entre o início de novas chamadas</strong></li>
          <li><strong>Tempo de duração das chamadas</strong></li>
          <li><strong>Intervalo entre pacotes de uma chamada</strong></li>
        </ul>
        <p>Para este cenário, assumimos que:</p>
        <ul>
          <li>
            <strong>Intervalo entre o início de novas chamadas:</strong> segue
            uma distribuição exponencial com média \(\leq 30 \) segundos.
          </li>
          <li>
            <strong>Tempo de duração das chamadas:</strong> segue uma
            distribuição exponencial com média de \(\geq 60 \) segundos.
          </li>
        </ul>
        <p>
          Foi estabelecido que as chamadas utilizam o CODEC
          <strong>G.711</strong>, cujas características são:
        </p>
        <ul>
          <li>
            Taxa de geração dos pacotes:
            <strong>64 Kbps</strong>
          </li>
          <li>
            Intervalo entre pacotes de uma chamada: <b>20 ms</b>, seguindo o
            padrão <strong>CBR (Constant Bit Rate)</strong>. Isso significa que
            a transmissão de bits será constante e, consequentemente, o tamanho
            dos pacotes também.
          </li>
        </ul>
        <p>Com o cenário definido, podemos prosseguir com os cálculos.</p>

        <div>
          <h3>Ocupação</h3>
          <p>
            <b>Restrição imposta:</b><br />
            A ocupação do link deve obedecer os seguintes cenários:
          </p>
          <ul class="inline">
            <li>\(\rho_1\) = 60%</li>
            <li>\(\rho_2\) = 80%</li>
            <li>\(\rho_3\) = 95%</li>
            <li>\(\rho_4\) = 99%</li>
          </ul>
          <p>
            Assim, devemos calcular o tamanho do link (\(R\)) previamente para
            que ao final da execução esses cenários sejam satisfeitos.
          </p>
          <p>
            Utilizaremos a fórmula derivada no
            <a href="https://otaviofbrito.github.io/Network-Simulation/report_web/report.html" title="Simulação Parte 1">artigo anterior</a>
            para calcular a capacidade de atendimento do link em bytes/s,
            garantindo que as utilizações desejadas sejam alcançadas:
          </p>
          <p class="tex_result">$$R = \frac{L \cdot \lambda}{\rho}$$</p>
        </div>
        <div>
          <h3>Taxa de chegada de pacotes no sistema (\(\lambda\))</h3>
          <p>
            A taxa de chegada de pacotes no sistema será a soma da taxa de
            chegada de pacotes de navegação web e da taxa de chegada de pacotes
            de chamadas em tempo real. Porém, conforme apontado anteriormente, 
            múltiplas chamadas podem ocorrer simultaneamente. Assim, a taxa de
            chegada de pacotes de chamadas em tempo real deve ser multiplicada
            pelo número de chamadas simultâneas no sistema \((N)\).
          </p>
          <p class="tex_result">
            $$\lambda = \lambda_{web} + (\lambda_{call} * N)$$
          </p>
          <div>
            O número médio de chamadas simultâneas pode ser calculado por: $$N =
            \frac{\text{Tempo de duração das chamadas}}{\text{Intervalo entre o início de novas chamadas }}$$
            Estabelecemos os seguintes valores na simulação:
            <ul>
              <li>Tempo de duração das chamadas = \(60\)s</li>
              <li>Intervalo entre o início de novas chamadas = \(30\)s</li>
            </ul>
            $$N = \frac{60}{30} = 2 \, \text{chamadas}$$
          </div>

          <div>
            A taxa de chegada de pacotes de navegação web se mantêm o mesmo. Com a inclusão da possibilidade de realização de chamadas, também devemos encontrar a taxa de chegada de pacotes para esse cenário.
            <ul>
              <li>\(\lambda_{web} = 100 \, \text{pacotes/s}\)</li>
              <li>
                \(\lambda_{call} = \frac{1}{0.02} * N = 50 * 2 = 100 \,
                \text{pacotes/s}\)
              </li>
            </ul>

            $$\lambda = \lambda_{web} + \lambda_{call} * N$$ $$\lambda = 100 +
            100 $$ $$\lambda = 200 \, \text{pacotes/s}$$
          </div>
        </div>
        <div>
          <h3>Tamanho Médio dos Pacotes do sistema (\(L\))</h3>
          <div>
            <p>
              Como possuímos dois tipos de pacotes sendo atendidos neste sistema, o tamanho médio
              do pacote, do sistema como todo, deve ser calculado com base na probabilidade
              de chegada de cada um dos dois tipos:
            </p>

            <p class="tex_result">
              $$L = L_{web} * P_{web} +L_{call} * P_{call}$$
            </p>
            <ul>
              <li>
                \(L\): Tamanho médio em <i>bytes</i> dos pacotes que chegam no
                sistema
              </li>
              <li>
                \(L_{web}\): Tamanho médio em <i>bytes</i> dos pacotes de
                navegação web
              </li>
              <li>
                \(L_{call}\): Tamanho médio em <i>bytes</i> dos pacotes de
                chamada em tempo real
              </li>
              <li>
                \(P_{web}\): Probabilidade de um pacote gerado ser de navegação
                web
              </li>
              <li>
                \(P_{call}\): Probabilidade de um pacote gerado ser de uma
                chamada em tempo real
              </li>
            </ul>

            <p>
              O tamanho médio dos pacotes de navegação web pode ser calculado
              com base nas proporções fornecidas: $$L_{web} = (0.5 \times 550) +
              (0.4 \times 40) + (0.1 \times 1500)$$ $$L_{web} = 441 \
              \text{bytes}$$
            </p>

            <p>
              Já o tamanho médio dos pacotes de chamada em tempo real pode ser
              calculado com base em suas particularidades:  Temos que a taxa de
              geração é de 64 Kbps: $$ 64 \, \text{Kbps} = \frac{64 \times 1000
              }{8} = 8000 \, \text{bytes/s} $$ Como cada pacote é gerado a uma
              taxa de <b>20 ms</b>: $$ 8000 \times 0,02 = 160 \, \text{bytes} $$
              $$L_{call} = 160 \ \text{bytes}$$
            </p>

            <p>
              O próximo passo é calcular a probabilidade de chegada de cada
              pacote, para isso precisamos ter conhecimento da taxa de chagada
              de pacotes no sistema \((\lambda)\). $$P_{web} =
              \frac{\lambda_{web}}{\lambda} = \frac{100}{200} = 0.5$$ $$P_{call}
              = \frac{\lambda_{call}}{\lambda} = \frac{100}{200} = 0.5$$
            </p>
            <p>
              Com isso. podemos finalizar o cálculo do tamanho médio do pacote no
              sistema: $$L = L_{web} * P_{web} +L_{call} * P_{call}$$
              Substituindo os valores: $$L = 441 * 0.5 + 160 * 0.5$$ $$L = 300.5
              \, \text{bytes}$$
            </p>
          </div>
        </div>

        <div>
          <h3>Tamanho do Link (\(R\))</h3>
          Agora que dispomos de todos os valores necessários, podemos calcular o
          tamanho do link para cada ocupação desejada.
        </div>
        <div>
          <h3>Cálculo da Capacidade do Link para as diversas ocupações</h3>
          <p>
            Com a fórmula obtida, podemos calcular a capacidade do link
            previamente para diferentes ocupações.
          </p>
          <div>
            Temos que:
            <ul>
              <li>\(\lambda = 200 \ \text{pcts/s}\)</li>
              <li>\(L_{médio} = 300.5\ \text{bytes}\)</li>
              <li>\(\rho = \{0.6, 0.8, 0.95, 0.99\}\)</li>
            </ul>
          </div>
          <ol>
            <li>
              60% de ocupação: $$R_{60\%} = \frac{ 300.5 \cdot 200}{0.6} \approx
              100166,6667 \ \text{bytes/s}$$
            </li>
            <li>
              80% de ocupação: $$R_{80\%} = \frac{ 300.5 \cdot 200}{0.8} = 75125
              \ \text{bytes/s}$$
            </li>
            <li>
              95% de ocupação: $$R_{95\%} = \frac{ 300.5 \cdot 200}{0.95}
              \approx 63263,1579 \ \text{bytes/s}$$
            </li>
            <li>
              99% de ocupação: $$R_{99\%} = \frac{ 300.5 \cdot 200}{0.99}
              \approx 60707,0707 \ \text{bytes/s}$$
            </li>
          </ol>
        </div>
      </div>
      <div class="section">
        <h3>Resultado das Simulações</h3>
        <h4>Pacotes de Navegação Web + Ligação em Tempo Real:</h4>
        {{ fig1|safe }}
        <h4>Pacotes de Ligação em Tempo Real:</h4>
        {{ fig2|safe }}
      </div>
      <hr class="stylized-line" />
      <div class="section">
        <h2>Medidas de Desempenho</h2>
        <p>
          A seguir foram calculadas medidas de desempenho com base em cada
          simulação realizada, cada gráfico conta com uma legenda onde estão
          classificadas as simulações e seus respectivos parâmetros de execução:
        </p>
        <ul>
          <li>
            <b
              >R: Tamanho do Link(bytes/s)</b
            >
          </li>
          <li><b>Semente aleatória = 100</b></li>
          <li><b>Tempo de simulação = 100.000 segundos</b></li>
        </ul>

        Em algumas medidas, existem campos que podem ser utilzados para validar
        o desempenho do sistema. *Clique nas legendas para ocultar os gráficos
        para uma melhor visualização
        <h3>1. Utilização/Ocupação (\(\rho\))</h3>

        {{ fig3|safe }}
        <div>
          <h3>Validação da utilização</h3>
        </div>
        <p>Calcule \(\rho\) através da equação obtida:</p>
        <div class="validate">
          <div class="left_params">
            <div class="input">
              <label for="ocup_lambda"> \(\lambda\):</label>
              <input
                type="number"
                id="ocup_lambda"
                placeholder="pcts/s"
                value="200"
                min="0"
                step="0.05"
              />
            </div>

            <div class="input">
              <label for="ocup_l"> \(L\):</label>
              <input
                type="number"
                id="ocup_l"
                placeholder="bytes"
                value="300.5"
                min="0"
                step="1"
              />
            </div>

            <div class="input">
              <label for="ocup_r"> \(R\):</label>
              <input
                type="number"
                id="ocup_r"
                placeholder="(bytes/s)"
                value="100066.6667"
                min="0"
                step="0.1"
              />
            </div>
          </div>

          <div class="calc">
            <div class="conta">
              <p>$$\rho = \frac{\lambda \cdot L}{R}$$</p>
              <p id="ocup_res"></p>
            </div>
            <button onclick="calcular_rho()">Calcular</button>
          </div>
        </div>
      </div>
      <hr class="stylized-line" />
      <div class="section">
        <h3>
          3. Média de elementos no sistema (\(E[N]\)) & Tempo médio de espera
          (\(E[W]\))
        </h3>
        <h4>Pacotes de Navegação Web + Ligação em Tempo Real:</h4>
        {{ fig4|safe }} {{ fig5|safe }} {{ fig6|safe }}

        <h4>Pacotes de Ligação em Tempo Real:</h4>

        {{ fig7|safe }} {{ fig8|safe }} {{ fig9|safe }}
        <div>
          <h3>Validação \(E[N]\) e \(E[W]\)</h3>
        </div>

        <p>Calcule \(E[N]\) e \(E[W]\) através das fórmulas:</p>
        <div class="validate">
          <div class="left_params">
            <div class="input">
              <label for="e_rho"> \(\rho\):</label>
              <input
                type="number"
                id="e_rho"
                placeholder="ρ"
                value="0.6"
                min="0"
                step="0.05"
              />
            </div>

            <div class="input">
              <label for="e_lambda"> \(\lambda\):</label>
              <input
                type="number"
                id="e_lambda"
                placeholder="pcts/s"
                value="200"
                min="0"
                step="0.1"
              />
            </div>

            <div class="input">
              <label for="e_l"> \(L\):</label>
              <input
                type="number"
                id="e_l"
                placeholder="bytes"
                value="300.5"
                min="0"
                step="1"
              />
            </div>
            <div class="input">
              <label for="e_r"> \(R\):</label>
              <input
                type="number"
                id="e_r"
                placeholder="bytes/s"
                value="100066.6667"
                min="0"
                step="0.1"
              />
            </div>
          </div>

          <div class="calc">
            <div class="conta">
              <p>$$E[N] = \frac{\rho}{1-\rho}$$</p>
              <p id="e_res"></p>
            </div>
            <button onclick="calcular_EN()">Calcular</button>
          </div>

          <div class="calc">
            <div class="conta">
              <p>$$E[W] = \frac{L}{R - L \cdot \lambda}$$</p>
              <p id="w_res"></p>
            </div>
            <button onclick="calcular_EW()">Calcular</button>
          </div>
        </div>
      </div>
      <hr class="stylized-line" />
      <div class="section">
        <h3>
          4. Taxa de chegada de elementos no sistema \(\left(\lambda\right)\) e
          Taxa de atendimento \(\left(\mu\right)\)
        </h3>
        <p>
          A taxa de chegada de elementos no sistema \((\lambda)\) é passada como
          parâmetro inicial e representa o inverso do tempo médio entre as
          chegadas dos pacotes. Já a taxa de atendimento (\(\mu\)) pode ser
          calculada como o inverso do tempo médio da atendimento ( ou atraso de
          transmissão - \(L/R)\).
        </p>
        <div class="rate">
          <p>$$\lambda = \frac{1}{\text{Tempo médio entre as chegadas}}$$</p>
          <p>$$\mu = \frac{R}{L}$$</p>
        </div>

        {{ fig10|safe }}

        <p>Calcule \(\mu\) através da equação obtida:</p>
        <div class="validate">
          <div class="left_params">
            <div class="input">
              <label for="mu_l"> \(L\):</label>
              <input
                type="number"
                id="mu_l"
                placeholder="bytes"
                value="300.5"
                min="0"
                step="1"
              />
            </div>

            <div class="input">
              <label for="mu_r"> \(R\):</label>
              <input
                type="number"
                id="mu_r"
                placeholder="(bytes/s)"
                value="100066.6667"
                min="0"
                step="0.1"
              />
            </div>
          </div>

          <div class="calc">
            <div class="conta">
              <p>$$\mu = \frac{R}{L}$$</p>
              <p id="mu_res"></p>
            </div>
            <button onclick="calcular_mu()">Calcular</button>
          </div>
        </div>
        <hr class="stylized-line" />
        <div class="section">
          <h3>5. Erro de Little</h3>
          <p>Lei de Little: $$E[N] = \lambda \cdot E[W]$$</p>
          <p>
            $$\text{Erro de Little} = \left| E[N] - \lambda \cdot E[W] \right|$$
          </p>

          <h4>Pacotes de Navegação Web + Ligação em Tempo Real:</h4>
          {{ fig11|safe }}

          <h4>Pacotes de Ligação em Tempo Real:</h4>
          {{ fig12|safe }}
        </div>
        <hr class="stylized-line" />
        <div class="section">
          <h3>Referências</h3>
          <ol>
            <li>
              <p>
                ROSS, S. M., <em>Simulation</em>. 4ª ed. San Diego: Academic
                Press, 2006.
              </p>
            </li>
            <li>
              <p>
                ALLEN, Arnold O.
                <em
                  >Probability, statistics, and queueing theory: with computer
                  science applications</em
                >. 2. ed. San Diego: Academic Press, 1990.
              </p>
            </li>
          </ol>
        </div>

        <hr class="stylized-line" />

        <footer>
          <p>
            &copy; 2024 Otávio Brito &
            <a href="https://github.com/aliciagarnier" target="_blank"
              >Alicia Garnier</a
            >.
          </p>
          <a href="https://github.com/otaviofbrito/Network-Simulation"
            >GitHub</a
          >
        </footer>
      </div>
    </div>
  </body>
</html>
